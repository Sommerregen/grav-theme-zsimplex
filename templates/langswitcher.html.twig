<ul class="langswitcher">
    {% set langobj = grav['language'] %}

    {% for key in langswitcher.languages %}

        {% if key == langswitcher.current %}
            {% set lang_url = page.url %}
            {% set active_class = ' active' %}
        {% else %}
            {% set lang_url = base_url_simple ~ langobj.getLanguageURLPrefix(key)~langswitcher.page_route~page.urlExtension ?: '/' %}
            {% set active_class = '' %}
        {% endif %}

        <li><a href="{{ lang_url ~ uri.params }}" class="external{{ active_class }}">{{  native_name(key)|capitalize }}</a></li>

    {% endfor %}
</ul>